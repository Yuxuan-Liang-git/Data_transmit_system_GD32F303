# Data_transmit_system_GD32F303

基于风机叶片的数据采集系统

- [x] 硬件设置IP地址

  基本完成，目前还不需要单独设置IP地址

  2023年3月20日

  已实现该功能

- [x] 网络通信

  2023年3月25日

  UDP通信成功。上位机可以用UDP协议正常发送数据给板子，但目前还未实际测试过上位机是否能正常接受下位机回传数据。

- [x] DMA存储信息

- [x] ADC采样

  2023年3月20日

  修改系统时钟，实现精确定时

  2023年4月20日

  改用了定时器中断的方式触发ADC采样，现在采样频率可以自己定了！

- [x] 数据打包发回

  2023年3月25日

  UDP通讯成功！但是只能电脑发数据给板子，板子发回来的数据电脑收不到...

  2023年4月1日

  改换TCP通讯，已实现主从机信息交流；增加地址修改选项，可用硬件修改从机IP地址

  2023年4月26日

  实现数据打包功能，之前由于TCP握手过于频繁导致网络堵塞。现在定义了4KB的缓存，将采集到的数据存到缓存中，以3.2ms的时间间隔发数据。

- [x] 上位机数据解包

  2023年4月27日

  实现单通道解包，晚些时候来写多通道的解包。

  2023年5月1日

  解包完成，会出现丢包的问题。

  2023年5月3日

  打包发送时会影响ADC的实时性。

  2023年5月5日

  中断无法解决实时性问题。尝试使用FreeRTOS。

  不行，FreeRTOS频率太低，无法满足要求。

  2023年5月30日

  使用计时器分析了每一段操作用时，发现网络通信部分用时过长，改用DMA的方式进行SPI通讯，速率明显提升，实现功能。

- 2023年6月17日

  新增频率修改功能。

## 文件结构

* doc：相关资料（内有功能示意演示视频、论文等）

  ```
  W5500通讯模块相关资料：
  链接：https://pan.baidu.com/s/18g0XSsEQwIjRH9HKTPR-ow 
  提取码：3xox 
  --来自百度网盘超级会员V6的分享
  ```

* LabView：上位机
  
  * UDP接收所有IP数据并存储（To do）
  * UDP接收特定IP数据
  * TCP定向接受特定IP数据：TCP会很卡，没有进一步开发
  
* tcp_com：使用Tcp通讯的嵌入式部分代码（TCP很卡，没有进一步开发）

* udp_com：使用Udp通讯的嵌入式部分代码
